---
// src/components/BlogCatalogue.astro
import type { CollectionEntry } from "astro:content";

// Get current locale from Astro's global
const { currentLocale } = Astro;
const locale = currentLocale || "yue"; // Fallback to default if undefined

// --- Title Translations ---
const titleTranslations: Record<string, string> = {
  yue: "文章", // Article List
  en: "Blog",
  vi: "Tập văn", // Article List
  nan: "文章",
  wuu: "文章",
  cmn: "文章",
};

const title = titleTranslations[locale] || titleTranslations.yue;

interface Props {
  posts: CollectionEntry<"blog">[];
  currentSlug: string; // To highlight the current post
}

const { posts, currentSlug } = Astro.props;

// Sort posts, perhaps by date or title? Let's sort by title for now.
const sortedPosts = posts.sort((a, b) =>
  a.data.title.localeCompare(b.data.title)
);
---

<nav aria-label="Blog Catalogue">
  <h2 class="text-2xl px-4 font-bold mb-4">{title}</h2>
  <ul class="space-y-2 px-4">
    {
      sortedPosts.map((post) => {
        const postSlug = post.slug.substring(4); // Remove 'yue/' prefix
        const isActive = postSlug === currentSlug;
        return (
          <li>
            <a
              href={`/blog/${postSlug}/`}
              class:list={[
                "block text-lg hover:text-blue-500",
                { "font-bold": isActive }, // Highlight active link
              ]}
              aria-current={isActive ? "page" : false}
            >
              {post.data.title}
            </a>
          </li>
        );
      })
    }
  </ul>
</nav>
